import{j as i}from"./jsx-runtime-D_zvdyIk.js";import{r as f}from"./iframe-DXGdv9s6.js";import{I as D}from"./input-0b3KJ0dD.js";import{I as j}from"./icon-D_wT1Xp1.js";function q({items:e,itemHeight:t,containerHeight:a,overscan:l=5}){const[s,u]=f.useState(0),o=f.useRef(null),c=e.length*t,r=Math.max(0,Math.floor(s/t)-l),g=Math.min(e.length-1,Math.floor((s+a)/t)+l),v=[];for(let n=r;n<=g;n++)v.push({item:e[n],index:n,offsetTop:n*t});const C=f.useCallback(n=>{const p=n.target.scrollTop;u(p)},[]),x=n=>{if(!o.current)return;const p=n*t,d=p+t,h=o.current,w=h.scrollTop,E=w+a;p<w?h.scrollTop=p:d>E&&(h.scrollTop=d-a)};return{virtualItems:v,containerProps:{ref:o,style:{maxHeight:`${a}px`,overflowY:"auto",position:"relative",willChange:"transform"},onScroll:C},innerProps:{style:{height:`${c}px`,position:"relative",width:"100%"}},scrollInfo:{scrollTop:s,viewportHeight:a,totalHeight:c,startIndex:r,endIndex:g},scrollToIndex:x}}try{q.displayName="useVirtualListScroll",q.__docgenInfo={description:"A custom hook to implement virtual scrolling for a list of items.",displayName:"useVirtualListScroll",props:{items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"T[]"}},itemHeight:{defaultValue:null,description:"",name:"itemHeight",required:!0,type:{name:"number"}},containerHeight:{defaultValue:null,description:"",name:"containerHeight",required:!0,type:{name:"number"}},overscan:{defaultValue:{value:"5"},description:"",name:"overscan",required:!1,type:{name:"number"}}}}}catch{}const y={"rst-list":"_rst-list_1suxi_1","rst-list-virtualScroll":"_rst-list-virtualScroll_1suxi_16","rst-list-input":"_rst-list-input_1suxi_20","rst-list-container":"_rst-list-container_1suxi_25","rst-list-listItem":"_rst-list-listItem_1suxi_30","rst-list-listItem-create":"_rst-list-listItem-create_1suxi_46","rst-list-noElements":"_rst-list-noElements_1suxi_65"};function L(e,t){if(!t)return e;const a=e.toLowerCase(),l=t.toLowerCase(),s=a.indexOf(l);if(s===-1)return e;const u=e.slice(0,s),o=e.slice(s,s+t.length),c=e.slice(s+t.length);return i.jsxs("span",{children:[u,i.jsx("strong",{children:o}),c]})}const S=(e,t,a)=>{const l=e.filter(c=>c.value.toLowerCase().includes(t.toLowerCase())),s=l.some(c=>c.value.toLowerCase()===t.toLowerCase()),u=!!(a&&t&&!s),o=u?[...l,{value:`__create__${t}`}]:l;return{filteredOptions:l,fullOptions:o,showCreateItem:u}},b=({e,localSelectedIndex:t,setLocalSelectedIndex:a,filteredOptions:l,fullOptions:s,onClick:u,onCreate:o,onKeyDown:c})=>{if(e.key==="ArrowDown"||e.key==="ArrowUp"){e.preventDefault();let r=t;e.key==="ArrowDown"?r=t<l.length-1?t+1:0:e.key==="ArrowUp"&&(r=t>0?t-1:l.length-1),a(r)}else if(e.key==="Enter"){const r=s[t];r?.value.startsWith("__create__")?o?.(r.value.replace("__create__","")):r&&u?.(r)}else e.key==="Escape"&&(e.preventDefault(),e.stopPropagation());c?.(e)};try{L.displayName="highlightMatch",L.__docgenInfo={description:"Highlights the part of the `text` that matches the `query` using a <strong> tag.",displayName:"highlightMatch",props:{}}}catch{}try{S.displayName="getFullOptions",S.__docgenInfo={description:'Filters the provided options based on the filter string, and appends a "create new item" option\nif the filter does not exactly match any existing option and `onCreate` is provided.',displayName:"getFullOptions",props:{}}}catch{}try{b.displayName="handleKeyNavigation",b.__docgenInfo={description:"Handles keyboard navigation within a list component, including arrow navigation, selection (Enter),\nand escape behavior. Also triggers `onClick`, `onCreate`, or `onKeyDown` as needed.",displayName:"handleKeyNavigation",props:{e:{defaultValue:null,description:"",name:"e",required:!0,type:{name:"KeyboardEvent<Element>"}},localSelectedIndex:{defaultValue:null,description:"",name:"localSelectedIndex",required:!0,type:{name:"number"}},setLocalSelectedIndex:{defaultValue:null,description:"",name:"setLocalSelectedIndex",required:!0,type:{name:"(i: number) => void"}},filteredOptions:{defaultValue:null,description:"",name:"filteredOptions",required:!0,type:{name:"Option[]"}},fullOptions:{defaultValue:null,description:"",name:"fullOptions",required:!0,type:{name:"Option[]"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"((option: Option) => void)"}},onCreate:{defaultValue:null,description:"",name:"onCreate",required:!1,type:{name:"((value: string) => void)"}},onKeyDown:{defaultValue:null,description:"",name:"onKeyDown",required:!1,type:{name:"((e: KeyboardEvent<Element>) => void)"}}}}}catch{}const O=({id:e,options:t,ref:a,selectedIndex:l=null,activeIndex:s=[],width:u,onClick:o,onKeyDown:c,onCreate:r})=>{const g=f.useRef(null),[v,C]=f.useState(""),x=24,[n,p]=f.useState(l!==null?l:-1);f.useEffect(()=>{g.current?.focus()},[]);const{filteredOptions:d,fullOptions:h}=S(t,v,r),{virtualItems:w,containerProps:E,innerProps:k,scrollToIndex:T}=q({items:h,itemHeight:x,containerHeight:200,overscan:5});f.useEffect(()=>{l!==null&&l!==n&&p(l)},[l]),f.useEffect(()=>{n>=0&&n<d.length&&T(n)},[n,d]);const _={wrapper:`${y["rst-list"]}`,input:`${y["rst-list-input"]}`,container:`${y["rst-list-container"]}`,virtualScroll:`${y["rst-list-virtualScroll"]}`,listItem:`${y["rst-list-listItem"]}`,listItemCreate:`${y["rst-list-listItem-create"]}`,noElements:`${y["rst-list-noElements"]}`};return i.jsxs("div",{id:e,ref:a,className:_.wrapper,"data-component":"list",style:{width:u},children:[i.jsx("div",{className:_.input,children:i.jsx(D,{value:v,placeholder:"Search...",onChange:C,onKeyDown:m=>b({e:m,localSelectedIndex:n,setLocalSelectedIndex:p,filteredOptions:d,fullOptions:h,onClick:o,onCreate:r,onKeyDown:c}),ref:g})}),i.jsx("div",{...E,className:_.container,tabIndex:0,role:"listbox","aria-label":"List",onKeyDown:m=>b({e:m,localSelectedIndex:n,setLocalSelectedIndex:p,filteredOptions:d,fullOptions:h,onClick:o,onCreate:r,onKeyDown:c}),"aria-activedescendant":n>=0&&n<d.length?d[n]?.value:void 0,children:i.jsx("div",{...k,className:_.virtualScroll,children:d.length===0&&!r?i.jsx("div",{className:_.noElements,children:"No elements"}):w.map(({item:m,index:I,offsetTop:$})=>{const N=m.value.startsWith("__create__"),V=N?m.value.replace("__create__",""):m.value,K=s.includes(m.value);return i.jsx("li",{role:"option",id:m.value,"aria-selected":n===I,tabIndex:-1,className:`${_.listItem} ${n===I?"selected-item":""}`,"aria-label":V,style:{height:`${x}px`,lineHeight:`calc(${x}px - 2*2px)`,transform:`translateY(${$}px)`},onClick:()=>{N?r?.(V):(o?.(m),p(I))},children:N?i.jsxs("span",{className:_.listItemCreate,children:[i.jsx(j,{icon:"plus"})," ",i.jsx("strong",{children:V})]}):i.jsxs(i.Fragment,{children:[L(V,v),K&&i.jsx(j,{icon:"check"})]})},I)})})})]})};try{O.displayName="List",O.__docgenInfo={description:"",displayName:"List",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}},options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"Option[]"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<HTMLElement | null>"}},showFilter:{defaultValue:null,description:"",name:"showFilter",required:!1,type:{name:"boolean"}},selectedIndex:{defaultValue:{value:"null"},description:"",name:"selectedIndex",required:!1,type:{name:"number"}},activeIndex:{defaultValue:{value:"[]"},description:"",name:"activeIndex",required:!1,type:{name:"string[]"}},width:{defaultValue:null,description:"",name:"width",required:!1,type:{name:"number"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"((option: Option) => void)"}},onKeyDown:{defaultValue:null,description:"",name:"onKeyDown",required:!1,type:{name:"((e: KeyboardEvent<Element>) => void)"}},onCreate:{defaultValue:null,description:`Callback to create a new option
@param value option value
@returns`,name:"onCreate",required:!1,type:{name:"((value: string) => void)"}}}}}catch{}export{O as L};
