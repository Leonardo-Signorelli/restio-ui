import{j as a}from"./jsx-runtime-D_zvdyIk.js";import{r as h}from"./iframe-Bxccsplp.js";import{I as M}from"./input-BZ3Aepug.js";import{I as k}from"./icon-6NFk8oT5.js";function E({items:e,itemHeight:t,containerHeight:s,overscan:n=5}){const[r,p]=h.useState(0),i=h.useRef(null),o=e.length*t,l=Math.max(0,Math.floor(r/t)-n),V=Math.min(e.length-1,Math.floor((r+s)/t)+n),g=[];for(let u=l;u<=V;u++)g.push({item:e[u],index:u,offsetTop:u*t});const b=h.useCallback(u=>{const m=u.target.scrollTop;p(m)},[]),w=u=>{if(!i.current)return;const m=u*t,f=m+t,_=i.current,d=_.scrollTop,x=d+s;m<d?_.scrollTop=m:f>x&&(_.scrollTop=f-s)};return{virtualItems:g,containerProps:{ref:i,style:{maxHeight:`${s}px`,overflowY:"auto",position:"relative",willChange:"transform"},onScroll:b},innerProps:{style:{height:`${o}px`,position:"relative",width:"100%"}},scrollInfo:{scrollTop:r,viewportHeight:s,totalHeight:o,startIndex:l,endIndex:V},scrollToIndex:w}}try{E.displayName="useVirtualListScroll",E.__docgenInfo={description:"A custom hook to implement virtual scrolling for a list of items.",displayName:"useVirtualListScroll",props:{items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"T[]"}},itemHeight:{defaultValue:null,description:"",name:"itemHeight",required:!0,type:{name:"number"}},containerHeight:{defaultValue:null,description:"",name:"containerHeight",required:!0,type:{name:"number"}},overscan:{defaultValue:{value:"5"},description:"",name:"overscan",required:!1,type:{name:"number"}}}}}catch{}const v={"rst-list":"_rst-list_132ef_1","rst-list-virtualScroll":"_rst-list-virtualScroll_132ef_15","rst-list-input":"_rst-list-input_132ef_19","rst-list-container":"_rst-list-container_132ef_24","rst-list-listItem":"_rst-list-listItem_132ef_29","rst-list-listItem-create":"_rst-list-listItem-create_132ef_45","rst-list-noElements":"_rst-list-noElements_132ef_64"};function L(e,t){if(!t)return e;const s=e.toLowerCase(),n=t.toLowerCase(),r=s.indexOf(n);if(r===-1)return e;const p=e.slice(0,r),i=e.slice(r,r+t.length),o=e.slice(r+t.length);return a.jsxs("span",{children:[p,a.jsx("strong",{children:i}),o]})}const S=(e,t,s)=>{const n=e.filter(o=>o.value.toLowerCase().includes(t.toLowerCase())),r=n.some(o=>o.value.toLowerCase()===t.toLowerCase()),p=!!(s&&t&&!r),i=p?[...n,{value:`__create__${t}`}]:n;return{filteredOptions:n,fullOptions:i,showCreateItem:p}},q=({e,localSelectedIndex:t,setLocalSelectedIndex:s,filteredOptions:n,fullOptions:r,onClick:p,onCreate:i,onKeyDown:o})=>{if(e.key==="ArrowDown"||e.key==="ArrowUp"){e.preventDefault();let l=t;e.key==="ArrowDown"?l=t<n.length-1?t+1:0:e.key==="ArrowUp"&&(l=t>0?t-1:n.length-1),s(l)}else if(e.key==="Enter"){const l=r[t];l?.value.startsWith("__create__")?i?.(l.value.replace("__create__","")):l&&p?.(l)}else e.key==="Escape"&&(e.preventDefault(),e.stopPropagation());o?.(e)};try{L.displayName="highlightMatch",L.__docgenInfo={description:"Highlights the part of the `text` that matches the `query` using a <strong> tag.",displayName:"highlightMatch",props:{}}}catch{}try{S.displayName="getFullOptions",S.__docgenInfo={description:'Filters the provided options based on the filter string, and appends a "create new item" option\nif the filter does not exactly match any existing option and `onCreate` is provided.',displayName:"getFullOptions",props:{}}}catch{}try{q.displayName="handleKeyNavigation",q.__docgenInfo={description:"Handles keyboard navigation within a list component, including arrow navigation, selection (Enter),\nand escape behavior. Also triggers `onClick`, `onCreate`, or `onKeyDown` as needed.",displayName:"handleKeyNavigation",props:{e:{defaultValue:null,description:"",name:"e",required:!0,type:{name:"KeyboardEvent<Element>"}},localSelectedIndex:{defaultValue:null,description:"",name:"localSelectedIndex",required:!0,type:{name:"number"}},setLocalSelectedIndex:{defaultValue:null,description:"",name:"setLocalSelectedIndex",required:!0,type:{name:"(i: number) => void"}},filteredOptions:{defaultValue:null,description:"",name:"filteredOptions",required:!0,type:{name:"Option[]"}},fullOptions:{defaultValue:null,description:"",name:"fullOptions",required:!0,type:{name:"Option[]"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"((option: Option) => void)"}},onCreate:{defaultValue:null,description:"",name:"onCreate",required:!1,type:{name:"((value: string) => void)"}},onKeyDown:{defaultValue:null,description:"",name:"onKeyDown",required:!1,type:{name:"((e: KeyboardEvent<Element>) => void)"}}}}}catch{}const T=({id:e,options:t,ref:s,activeIndex:n=[],width:r,anchorName:p,onClick:i,onKeyDown:o,onCreate:l,multiple:V=!1,selectedIndex:g=-1})=>{const b=h.useRef(null),[w,u]=h.useState(""),m=24,[f,_]=h.useState(g);h.useEffect(()=>{b.current?.focus()},[]),h.useEffect(()=>{_(g)},[g]);const{filteredOptions:d,fullOptions:x}=S(t,w,l),{virtualItems:$,containerProps:A,innerProps:K,scrollToIndex:j}=E({items:x,itemHeight:m,containerHeight:200,overscan:5});h.useEffect(()=>{if(Array.isArray(n)&&n.length>0){const c=d.findIndex(I=>I.value===n[0]);c!==-1&&j(c)}},[d,n,j]);const y={wrapper:`${v["rst-list"]}`,input:`${v["rst-list-input"]}`,container:`${v["rst-list-container"]}`,virtualScroll:`${v["rst-list-virtualScroll"]}`,listItem:`${v["rst-list-listItem"]}`,listItemCreate:`${v["rst-list-listItem-create"]}`,noElements:`${v["rst-list-noElements"]}`};return a.jsxs("div",{id:e,ref:s,className:y.wrapper,"data-component":"list",style:{width:r,positionAnchor:p},children:[a.jsx("div",{className:y.input,children:a.jsx(M,{value:w,placeholder:"Search...",onChange:u,onKeyDown:c=>q({e:c,localSelectedIndex:f,setLocalSelectedIndex:_,filteredOptions:d,fullOptions:x,onClick:i,onCreate:l,onKeyDown:o}),ref:b})}),a.jsx("div",{...A,className:y.container,tabIndex:0,role:"listbox","aria-label":"List","aria-multiselectable":V,onKeyDown:c=>q({e:c,localSelectedIndex:f,setLocalSelectedIndex:_,filteredOptions:d,fullOptions:x,onClick:i,onCreate:l,onKeyDown:o}),"aria-activedescendant":f>=0&&f<d.length?d[f]?.value:void 0,children:a.jsx("div",{...K,className:y.virtualScroll,children:d.length===0&&!l?a.jsx("div",{className:y.noElements,children:"No elements"}):$.map(({item:c,index:I,offsetTop:D})=>{const C=c.value.startsWith("__create__"),N=C?c.value.replace("__create__",""):c.value,O=n.includes(c.value);return a.jsx("li",{role:"option",id:c.value,"aria-selected":f===I,tabIndex:-1,className:`${y.listItem} ${O?"selected-item":""}`,"aria-label":N,style:{height:`${m}px`,lineHeight:`calc(${m}px - 2*2px)`,transform:`translateY(${D}px)`},onClick:()=>{C?l?.(N):(i?.(c),_(I))},children:C?a.jsxs("span",{className:y.listItemCreate,children:[a.jsx(k,{icon:"plus"})," ",a.jsx("strong",{children:N})]}):a.jsxs(a.Fragment,{children:[L(N,w),O&&a.jsx(k,{icon:"check"})]})},I)})})})]})};try{T.displayName="List",T.__docgenInfo={description:"",displayName:"List",props:{id:{defaultValue:null,description:"",name:"id",required:!1,type:{name:"string"}},options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"Option[]"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<HTMLElement | null>"}},showFilter:{defaultValue:null,description:"",name:"showFilter",required:!1,type:{name:"boolean"}},selectedIndex:{defaultValue:{value:"-1"},description:"",name:"selectedIndex",required:!1,type:{name:"number"}},activeIndex:{defaultValue:{value:"[]"},description:"",name:"activeIndex",required:!1,type:{name:"string[]"}},width:{defaultValue:null,description:"",name:"width",required:!1,type:{name:"number"}},anchorName:{defaultValue:null,description:"",name:"anchorName",required:!1,type:{name:"string"}},multiple:{defaultValue:{value:"false"},description:"Accepts multiple aria-selected",name:"multiple",required:!1,type:{name:"boolean"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!1,type:{name:"((option: Option) => void)"}},onKeyDown:{defaultValue:null,description:"",name:"onKeyDown",required:!1,type:{name:"((e: KeyboardEvent<Element>) => void)"}},onCreate:{defaultValue:null,description:`Callback to create a new option
@param value option value
@returns`,name:"onCreate",required:!1,type:{name:"((value: string) => void)"}}}}}catch{}export{T as L};
